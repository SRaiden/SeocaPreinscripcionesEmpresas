@model List<Sindicato_Viedma.Models.ViewModels.Archivos>

@{
    ViewData["Title"] = "Archivos";
}

<!-- Banner -->
@Html.Partial("~/Views/Shared/MisViews/Banner.cshtml")

@{
    if (ViewBag.Session != false) // Si esta logueado que se muestre la barra menu
    {
        @Html.Partial("~/Views/Shared/BarraNavegacion.cshtml")
    }
}
}

<div class="w3-content" style="max-width:1564px">
    <div class="w3-container bg-zul w3-xlarge w3-text-white">
        Subir Archivo SIAP
    </div>
    <br>
    <!-- -----||| C A B E C E R A |||----- -->

    <div class=" w3-container">
        <div class="w3-padding-16">
            <div class="w3-col w3-center" style="width:15%"><label><b>Cta. Nº:</b></label></div>
            <div class="w3-col w3-center" style="width:15%"><input class="w3-input w3-border w3-round" name="first" type="text" readonly value="@ViewBag.cuenta"></div>
            <div class="w3-col w3-center" style="width:15%"><label><b>Cuit:</b></label></div>
            <div class="w3-col w3-center" style="width:15%"><input class="w3-input w3-border w3-round" name="first" type="text" readonly value="@ViewBag.cuit"></div>
            <div class="w3-col w3-center" style="width:15%"><label><b>Sucursal:</b></label></div>
            <div class="w3-col w3-center" style="width:10%"><input class="w3-input w3-border w3-round" name="first" type="text" readonly value="@ViewBag.sucursal"></div>

        </div>

        <div class="w3-container">
            <div class="w3-panel">
                <div class="">
                    @using (Html.BeginForm("DescargarPlanillaEmpleados", "Importar", FormMethod.Post, new { @class = "w3-row w3-responsive" }))
                    {
                        <p>
                            Crear archivo de Excel con los
                            <b class="w3-zultxt"> datos de Empleados</b>:
                            <button class="w3-btn w3-small bg-zul" type="submit">Descargar Planilla</button>
                        </p>
                    }
                </div>
                <hr>
                <div class="w3-padding-32 w3-text-grey">
                    Según el navegador se le preguntará por la acción a tomar, selecione Guardar o "Save..."
                    luego seleccione la carpeta de SU computadora donde guardar el archivo para luego trabajar en el. <br>
                    Después de Editar los valores de EXCEL. Seleccione GRABAR COMO o SAVE AS de la opción Archivo del Menú.
                    Elija un nombre y .XLS como tipo de archivo y aceptar, este archivo que Ud. guardó  es el que debe subir para ser procesado
                </div>
            </div>
        </div>

        <div class="w3-panel">
            <div class="">
                @using (Html.BeginForm("DescargarPlantillaEmpleados", "Importar", FormMethod.Post, new { @class = "w3-row w3-responsive" }))
                {
                    <p>
                        Crear
                        <b class="w3-zultxt"> Plantilla de Empleados</b>:
                        <button class="w3-btn w3-small bg-zul" type="submit">Descargar Plantilla</button>
                    </p>
                }
            </div>
        </div>

        <div class="w3-row">
            @using (Html.BeginForm("DescargarTablas", "Importar", FormMethod.Post, new { @class = "w3-container", enctype = "multipart/form-data" }))
            {
                <h2 class="w3-xx">
                    Descargar Tablas: Tipo de Documentos / Categoria
                    <button class="w3-btn bg-zul w3-small w3-text-white" type="submit">Download</button>
                </h2>
            }
            <hr>

            <div class="w3-third w3-container w3-text-grey">
                @using (Html.BeginForm("ImportarTXT", "Importar", FormMethod.Post, new { @class = "w3-container", enctype = "multipart/form-data" }))
                {
                    <p>Subir Archivo SEOCA / Bicentenario </p>
                    <input type="radio" id="Seoca" name="tipo" value="Seoca" checked /><label> Seoca</label> <br />
                    <input type="radio" id="Bicentenario" name="tipo" value="Bicentenario" /><label> Bicentenario</label>
                    <br /><br />
                    <input type="file" name="txtFile" />
                    <button class="w3-btn bg-zul w3-small w3-round-large w3-right w3-text-white" type="submit">Previsualizar</button>
                }
            </div>

            <div class="w3-third w3-container">

            </div>

            <div class="w3-third w3-container w3-text-grey">

                <p>Subir Archivo Empleados </p>

                <input type="file" id="fileUpload" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" />
                <button class="w3-btn bg-zul w3-small w3-round-large w3-right w3-text-white" type="submit" onclick="UploadProcess()">Subir Archivo</button>

            </div>
            <br />
        </div>
    </div>

    <br />

    <div id="ExcelTable"></div>

    @if (ViewBag.listaEmpleados != null && ViewBag.tipo != null)
    {
        if (ViewBag.tipo == "Seoca")
        {
            <div class="w3-responsive w3-container w3-padding-16 w3-center">

                @using (Html.BeginForm("ImportarTablaSeocaTXT", "Importar", FormMethod.Post, new { @class = "w3-container" }))
                {
                    <input type="hidden" value="4" id="valorCuatro" />
                    <button class="w3-btn bg-zul w3-small w3-round-large w3-right w3-text-white" type="submit">Actualizar Grilla</button>
                }

                <br />

                <table class="w3-table-all tablaSeoca ">
                    <thead>
                        <tr class="bg-zul">
                            <th>Cuit</th>
                            <th>Apellido</th>
                            <th>Nombre</th>
                            <th style="display:none;">Sexo</th>
                            <th style="display:none;">Fecha Nacimiento</th>
                            <th style="display:none;">Afiliado</th>
                            <th>Fecha Ingreso</th>
                            <th>Remunerativo</th>
                            @*<th>No Remunerativo</th>*@
                            <th style="display:none;">Categoria</th>
                            <th style="display:none;">FechaBaja</th>
                            <th>Cant. Horas</th>
                            <th style="display:none;">Estado</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var lista in ViewBag.listaEmpleados)
                        {
                            <tr>
                                <td>@lista.CUIL</td>
                                <td>@lista.Apellido</td>
                                <td>@lista.Nombre</td>
                                <td style="display:none;">@lista.Sexo</td>
                                <td style="display:none;">@lista.Fecha_Nacimiento</td>
                                <td style="display:none;">@lista.Afiliado</td>
                                <td>@lista.Fecha_Ingreso</td>
                                <td>@lista.Remuneracion</td>
                                @*<td>@lista.NoRemuneracion</td>*@
                                <td style="display:none;">@lista.Categoria</td>
                                <td style="display:none;">@lista.Fecha_Baja</td>
                                <td>@lista.CantHoras</td>
                                <td style="display:none;">@lista.Estado</td>
                            </tr>
                        }
                    </tbody>
                </table>

            </div>
        }
        else
        {
            <div class="w3-responsive w3-container w3-padding-16 w3-center">

                @using (Html.BeginForm("ImportarTablaBicentenarioTXT", "Importar", FormMethod.Post, new { @class = "w3-container" }))
                {
                    <input type="hidden" value="5" id="valorCinco" />
                    <button class="w3-btn bg-zul w3-small w3-round-large w3-right w3-text-white" type="submit">Actualizar Grilla</button>
                }

                <br />

                <table class="w3-table-all tablaBicentenario ">
                    <thead class="w3-text-white">
                        <tr class="bg-zul">
                            <th class="">Cuit</th>
                            <th>Apellido</th>
                            <th>Nombre</th>
                            <th style="display:none;">Sexo</th>
                            <th style="display:none;">Fecha Nacimiento</th>
                            <th style="display:none;">Afiliado</th>
                            <th>Fecha Ingreso</th>
                            <th>Remunerativo ($)</th>
                            @*<th>No Remunerativo ($)</th>*@
                            <th style="display:none;">Categoria</th>
                            <th>Cant. Horas</th>
                            <th style="display:none;">Estado</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var lista in ViewBag.listaEmpleados)
                        {
                            <tr>
                                <td>@lista.CUIL</td>
                                <td>@lista.Apellido</td>
                                <td>@lista.Nombre</td>
                                <td style="display:none;">@lista.Sexo</td>
                                <td style="display:none;">@lista.Fecha_Nacimiento</td>
                                <td style="display:none;">@lista.Afiliado</td>
                                <td>@lista.FechaNacimiento</td>
                                <td>@lista.Remuneracion</td>
                                @*<td>@lista.NoRemuneracion</td>*@
                                <td style="display:none;">@lista.Categoria</td>
                                <td>@lista.CantHoras</td>
                                <td style="display:none;">@lista.Estado</td>
                            </tr>
                        }
                    </tbody>
                </table>

            </div>
        }
    }
    else
    {
        <div class="w3-responsive w3-container w3-padding-16 w3-center">
            <table class="w3-table-all">
                <tr class="bg-zul">
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                </tr>
            </table>
        </div>
    }

</div>

@if (!string.IsNullOrEmpty(ViewBag.resultado))
{
    <script type="text/javascript">
        alert("@ViewBag.resultado");
    </script>
}

@if (!string.IsNullOrEmpty(ViewBag.errorCuit))
{
    <script type="text/javascript">
        alert("@ViewBag.errorCuit");
    </script>
}

@if (!string.IsNullOrEmpty(ViewBag.archivo))
{
    <script type="text/javascript">
        alert("@ViewBag.archivo");
    </script>
}

@if (!string.IsNullOrEmpty(ViewBag.mensaje))
{
    <script type="text/javascript">
        alert("@ViewBag.mensaje");
    </script>
}

@if (!string.IsNullOrEmpty(ViewBag.error))
{
    <script type="text/javascript">
        alert("@ViewBag.error");
    </script>
}

@section scripts{
    <script src="~/js/Excel.js"></script>
}


